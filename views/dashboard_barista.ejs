<%- include('partials/header') -%>
<div class="container">
  <div class="row mt-5">
      <div class="col-6">
          <div>
              <p><strong>Welcome</strong>: <%= user.userName %></p>
              <p><strong>Email</strong>: <%= user.email %></p>
              <a href="/profile_barista" class="col-3 btn btn-primary">Profile</a>
              <a href="/logout" class="col-3 btn btn-primary">Logout</a>
          </div>
      </div>
      <!-- Search area -->

      <!-- Active shifts display section -->

      <section>
        <table>
          <caption>Active needs</caption>
          <thead>
            <tr>
              <th scope="col">Location</th>
              <th scope="col">Wage</th>
              <th scope="col">Date</th>
              <th scope="col">time</th>
            
            </tr>
          </thead>
            <% let activeShift = 0 %>
      

            <% for(let i = 0; i < shift.length; i++) { %>
              <!-- 1.44e+8 == 40 hours in milliseconds, due to date.now() get ms in UTC, so 4h+ from GMT-4 -->
              <% if (shift[i].activeStatus && shift[i].date >= (Date.now() - 1.44e+8) ) { %>
                <% activeShift++ %>
                <tr data-id="<%= shift[i]._id %>">
                  <th scope="row"><%= shift[i].location %></th>
                  <td><%= shift[i].wage %></td>
                  <td>
                  <!-- Set timeZone to UTC to prevent date short by 1 -->
                  <% let rightDate = new Date(+shift[i].date).toLocaleString('en-US', {weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', timeZone: 'UTC'} ) %>
                  <%= rightDate %> 
                  </td>
                  <td><%= `${shift[i].from_time} - ${shift[i].end_time}` %></td>
                  
                </tr>
              <% } %>
            <% }  %>
            <% if (shift.length == 0 || activeShift == 0 ){ %>
            <tr>
              <th colspan="4"><%= cafe.shopName %> has no active shift to display</th>
            </tr>
          
          <% }  %> 
        </table>
      </section>
    </div>
  </div>
</div>
<%- include('partials/footer') -%>