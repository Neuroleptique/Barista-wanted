<%- include('partials/header') -%>
<div>
  <div>
      <div>
          <div>
              <p><strong>Welcome</strong>: <%= cafe.cafeName %></p>
              <p><strong>Email</strong>: <%= user.email %></p>
              <a href="/profile_cafe" class="col-3 btn btn-primary">Profile</a>
              <a href="/logout" class="col-3 btn btn-primary">Logout</a>
          </div>
      </div>
      <section>
        <!-- Active shifts input section -->
        <form action="/cafe/postShift" method="POST">
          <label for="location">Location:</label>
          <input type="text" name="location" id="location" placeholder="Junction, Leslieville">
          <label for="wage">Hourly Wage:</label>
          <input type="number" name="wage" id="wege" placeholder="$15.5/hour" min="15.5">
          <label for="date">Date and Shift start time:</label>
          <input type="datetime-local" name="date" id="date">
          <label for="end_time">Shift end time:</label>
          <input type="time" name="end_time" id="end_time">
          <label for="more">Specification:</label>
          <input type="text" name="more" id="more" placeholder="Anything else you would like to add about the job?">
          <input type="text" name="userID" value="<%= user.id %>" hidden>
          <button type="submit">Submit</button>
        </form>
        <!-- active shift display -->
        <table>
          <caption>Active needs</caption>
          <thead>
            <tr>
              <th scope="col">Location</th>
              <th scope="col">Wage</th>
              <th scope="col">Date</th>
              <th scope="col">time</th>
              <th scope="col">Status</th>
            </tr>
          </thead>
            <% let activeShift = 0 %>
      

            <% for(let i = 0; i < shift.length; i++) { %>
              <% let shiftDate = new Date(shift[i].date) %>
              <% if (shift[i].activeStatus && shiftDate >= Date.now()) { %>
                <% activeShift++ %>
                <tr data-id="<%= shift[i]._id %>">
                  <th scope="row"><%= shift[i].location %></th>
                  <td><%= shift[i].wage %></td>
                  <td>

                  
                 
                  <%= shiftDate.toDateString() %> 
                  </td>
                  <td><%= `${shiftDate.getHours()}:${shiftDate.getMinutes()} - ${shift[i].end_time}` %></td>
                  <td>
                    <button type="button" id="editShift">Edit</button>
                    <button type="button" class="inactiveShift">Fulfilled</button>
                    <button type="button" class="deleteShift">Delete</button>
                  </td>
                </tr>
              <% } %>
            <% }  %>
            <% if (shift.length == 0 || activeShift == 0 ){ %>
            <tr>
              <th colspan="5"><%= cafe.cafeName %> has no active shift to display</th>
            </tr>
          
          <% }  %> 
        </table>
        <!-- Past/inactive shifts display area -->
        <table>
          <caption>Past request</caption>
          <thead>
            <tr>
              <th scope="col">Location</th>
              <th scope="col">Wage</th>
              <th scope="col">Date</th>
              <th scope="col">time</th>
              <th scope="col">Status</th>
            </tr>
          </thead>
          <% let pastShift = 0 %>
            <% for(let i = 0; i < shift.length; i++) { %>
              <% let shiftDate = new Date(shift[i].date) %>
              <% if (!shift[i].activeStatus || shiftDate < Date.now()) { %>
                <% pastShift++ %>
                <tr data-id="<%= shift[i]._id %>">
                  <th scope="row"><%= shift[i].location %></th>
                  <td><%= shift[i].wage %></td>
                  <td>
                                    
                  <%= shiftDate.toDateString() %> 
                  </td>
                  <td><%= `${shiftDate.getHours()}:${shiftDate.getMinutes()} - ${shift[i].end_time}` %></td>
                  <td>
                    <!-- <button type="button" id="activeStatusTrue">Re-active</button> -->
                    <button type="button" class="deleteShift">Delete</button>
                  </td>
                </tr>
              <% } %>
            <% }  %>
            <% if (shift.length == 0 || pastShift == 0 ){ %>
            <tr>
              <th colspan="5"><%= cafe.cafeName %> has no past shift to display</th>
            </tr>
          
          <% }  %> 
        </table>
      </section>
    </div>
  </div>
</div>
<%- include('partials/footer') -%>